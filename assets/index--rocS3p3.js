(function(){const O=document.createElement("link").relList;if(O&&O.supports&&O.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))n(_);new MutationObserver(_=>{for(const A of _)if(A.type==="childList")for(const i of A.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(_){const A={};return _.integrity&&(A.integrity=_.integrity),_.referrerPolicy&&(A.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?A.credentials="include":_.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function n(_){if(_.ep)return;_.ep=!0;const A=e(_);fetch(_.href,A)}})();/**
 * @license
 * @very-amused/argon2-wasm v0.4.0
 * MIT License
 * Copyright (c) 2025 Keith Scroggs
 */class D{constructor(O){this.worker=O,this.worker.addEventListener("message",e=>{this.onMessage(e)},!0)}onMessage(O){this.resolve&&this.resolve(O.data)}postMessage(O,e=[]){const n=new Promise(_=>{this.resolve=_});return this.worker.postMessage(O,e),n}terminate(){this.worker.removeEventListener("message",O=>{this.onMessage(O)},!0),this.worker.terminate()}}const u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function m(t,O){if(O[0]=u.charCodeAt(t[0]>>2),t.byteLength===1){O[1]=u.charCodeAt(t[0]<<4&48);return}if(O[1]=u.charCodeAt(t[0]<<4&48|t[1]>>4),t.byteLength===2){O[2]=u.charCodeAt(t[1]<<2&60);return}O[2]=u.charCodeAt(t[1]<<2&60|t[2]>>6),O[3]=u.charCodeAt(t[2]&63)}function M(t,O){O[0]=t[0]<<2|t[1]>>4,O.byteLength!==1&&(O[1]=t[1]<<4|t[2]>>2,O.byteLength!==2&&(O[2]=t[2]<<6|t[3]))}function d(t){let O=t.byteLength;for(let n=t.byteLength-2;n<t.byteLength;n++)t[n]===61&&O--;const e=new Uint8Array(O);for(let n=0;n<O;n++)if(t[n]>=48&&t[n]<=57)e[n]=t[n]+4;else if(t[n]>=65&&t[n]<=90)e[n]=t[n]-65;else if(t[n]>=97&&t[n]<=122)e[n]=t[n]-71;else if(t[n]===43)e[n]=62;else if(t[n]===47)e[n]=63;else throw new Error("invalid base64 input (StdEncoding)");return e}var l;(function(t){function O(n){const _=Math.floor(n.byteLength/3)*4+(n.byteLength%3!==0?4:0),A=new Uint8Array(_);let i=0,N=0;for(;i<n.byteLength-2;i+=3,N+=4)m(new Uint8Array(n.buffer,i,3),new Uint8Array(A.buffer,N,4));switch(n.byteLength%3){case 1:m(new Uint8Array(n.buffer,n.byteLength-1,1),new Uint8Array(A.buffer,_-4,2)),A[A.byteLength-2]=61,A[A.byteLength-1]=61;break;case 2:m(new Uint8Array(n.buffer,n.byteLength-2,2),new Uint8Array(A.buffer,_-4,3)),A[A.byteLength-1]=61;break}return new TextDecoder().decode(A)}t.encode=O;function e(n){const _=d(new TextEncoder().encode(n.replaceAll(/[\r\n]/g,""))),A=Math.floor(_.byteLength/4)*3+_.byteLength%4-(_.byteLength%4>0?1:0),i=new Uint8Array(A);let N=0,a=0;for(;N<_.byteLength-3;N+=4,a+=3)M(new Uint8Array(_.buffer,N,4),new Uint8Array(i.buffer,a,3));switch(_.byteLength%4){case 2:M(new Uint8Array(_.buffer,_.byteLength-2,2),new Uint8Array(i.buffer,i.byteLength-1,1));break;case 3:M(new Uint8Array(_.buffer,_.byteLength-3,3),new Uint8Array(i.buffer,i.byteLength-2,2));break}return i}t.decode=e})(l||(l={}));var T;(function(t){t.WorkerConnection=D,function(e){e.Argon2i="2i",e.Argon2d="2d",e.Argon2id="2id"}(t.Modes||(t.Modes={})),function(e){e[e.ARGON2_VERSION_10=16]="ARGON2_VERSION_10",e[e.ARGON2_VERSION_13=19]="ARGON2_VERSION_13",e[e.ARGON2_VERSION_NUMBER=19]="ARGON2_VERSION_NUMBER"}(t.Versions||(t.Versions={})),function(e){e[e.LoadArgon2=0]="LoadArgon2",e[e.Hash2i=1]="Hash2i",e[e.Hash2d=2]="Hash2d",e[e.Hash2id=3]="Hash2id",e[e.UnloadArgon2=4]="UnloadArgon2",e[e.Hash=5]="Hash"}(t.Methods||(t.Methods={})),function(e){e[e.ARGON2_OK=0]="ARGON2_OK",e[e.ARGON2_OUTPUT_PTR_NULL=-1]="ARGON2_OUTPUT_PTR_NULL",e[e.ARGON2_OUTPUT_TOO_SHORT=-2]="ARGON2_OUTPUT_TOO_SHORT",e[e.ARGON2_OUTPUT_TOO_LONG=-3]="ARGON2_OUTPUT_TOO_LONG",e[e.ARGON2_PWD_TOO_SHORT=-4]="ARGON2_PWD_TOO_SHORT",e[e.ARGON2_PWD_TOO_LONG=-5]="ARGON2_PWD_TOO_LONG",e[e.ARGON2_SALT_TOO_SHORT=-6]="ARGON2_SALT_TOO_SHORT",e[e.ARGON2_SALT_TOO_LONG=-7]="ARGON2_SALT_TOO_LONG",e[e.ARGON2_AD_TOO_SHORT=-8]="ARGON2_AD_TOO_SHORT",e[e.ARGON2_AD_TOO_LONG=-9]="ARGON2_AD_TOO_LONG",e[e.ARGON2_SECRET_TOO_SHORT=-10]="ARGON2_SECRET_TOO_SHORT",e[e.ARGON2_SECRET_TOO_LONG=-11]="ARGON2_SECRET_TOO_LONG",e[e.ARGON2_TIME_TOO_SMALL=-12]="ARGON2_TIME_TOO_SMALL",e[e.ARGON2_TIME_TOO_LARGE=-13]="ARGON2_TIME_TOO_LARGE",e[e.ARGON2_MEMORY_TOO_LITTLE=-14]="ARGON2_MEMORY_TOO_LITTLE",e[e.ARGON2_MEMORY_TOO_MUCH=-15]="ARGON2_MEMORY_TOO_MUCH",e[e.ARGON2_LANES_TOO_FEW=-16]="ARGON2_LANES_TOO_FEW",e[e.ARGON2_LANES_TOO_MANY=-17]="ARGON2_LANES_TOO_MANY",e[e.ARGON2_PWD_PTR_MISMATCH=-18]="ARGON2_PWD_PTR_MISMATCH",e[e.ARGON2_SALT_PTR_MISMATCH=-19]="ARGON2_SALT_PTR_MISMATCH",e[e.ARGON2_SECRET_PTR_MISMATCH=-20]="ARGON2_SECRET_PTR_MISMATCH",e[e.ARGON2_AD_PTR_MISMATCH=-21]="ARGON2_AD_PTR_MISMATCH",e[e.ARGON2_MEMORY_ALLOCATION_ERROR=-22]="ARGON2_MEMORY_ALLOCATION_ERROR",e[e.ARGON2_FREE_MEMORY_CBK_NULL=-23]="ARGON2_FREE_MEMORY_CBK_NULL",e[e.ARGON2_ALLOCATE_MEMORY_CBK_NULL=-24]="ARGON2_ALLOCATE_MEMORY_CBK_NULL",e[e.ARGON2_INCORRECT_PARAMETER=-25]="ARGON2_INCORRECT_PARAMETER",e[e.ARGON2_INCORRECT_TYPE=-26]="ARGON2_INCORRECT_TYPE",e[e.ARGON2_OUT_PTR_MISMATCH=-27]="ARGON2_OUT_PTR_MISMATCH",e[e.ARGON2_THREADS_TOO_FEW=-28]="ARGON2_THREADS_TOO_FEW",e[e.ARGON2_THREADS_TOO_MANY=-29]="ARGON2_THREADS_TOO_MANY",e[e.ARGON2_MISSING_ARGS=-30]="ARGON2_MISSING_ARGS",e[e.ARGON2_ENCODING_FAIL=-31]="ARGON2_ENCODING_FAIL",e[e.ARGON2_DECODING_FAIL=-32]="ARGON2_DECODING_FAIL",e[e.ARGON2_THREAD_FAIL=-33]="ARGON2_THREAD_FAIL",e[e.ARGON2_DECODING_LENGTH_FAIL=-34]="ARGON2_DECODING_LENGTH_FAIL",e[e.ARGON2_VERIFY_MISMATCH=-35]="ARGON2_VERIFY_MISMATCH",e[e.ARGON2WASM_UNKNOWN=1]="ARGON2WASM_UNKNOWN",e[e.ARGON2WASM_BAD_REQUEST=2]="ARGON2WASM_BAD_REQUEST",e[e.ARGON2WASM_UNSUPPORTED_BROWSER=3]="ARGON2WASM_UNSUPPORTED_BROWSER"}(t.ErrorCodes||(t.ErrorCodes={}));function O(e,n){return`$argon${e.mode}$v=${t.Versions.ARGON2_VERSION_NUMBER}$m=${e.memoryCost},t=${e.timeCost},p=${e.threads}$${l.encode(e.salt)}$${l.encode(n)}`}t.encode=O})(T||(T={}));const o=new T.WorkerConnection(new Worker("../argon2/worker.js")),c=document.querySelector.bind(document),R={password:c("input#password"),salt:c("input#salt"),textSalt:c("input#text_salt"),timeCost:c("input#t_cost"),memoryCost:c("input#m_cost"),threads:c("input#threads"),mode:c("select#argon2_mode"),simd:c("input#simd_enabled"),pthread:c("input#pthread_enabled"),run:c("input#submit"),result:c("span#result"),timer:c("section#timer"),timerValue:c("span#timer_value"),form:c("form#demoForm")};let y=R.simd.checked,p=R.pthread.checked;(async function(){const t=await o.postMessage({method:T.Methods.LoadArgon2,params:{wasmRoot:".",simd:y,pthread:p}});t.code!==0&&r(t.code)})();document.onclose=()=>{o.terminate()};function L(t){R.run.disabled=!1,R.result.textContent=t}function r(t){let O="";for(const e in T.ErrorCodes)if(T.ErrorCodes[e]===t){O=e;break}L(`Error: ${O} (code ${t})`)}R.form.onsubmit=async t=>{t.preventDefault(),R.run.disabled=!0,R.result.textContent="";const O=R.simd.checked,e=R.pthread.checked;if(O!==y||e!==p){const s=await o.postMessage({method:T.Methods.LoadArgon2,params:{wasmRoot:".",simd:O,pthread:e}});if(s.code!==0){r(s.code);return}y=O,p=e}let n,_=!1,A=R.salt.value,i=R.textSalt.value;if(i.length>=8)n=new TextEncoder().encode(i),_=!0;else if(A.length>0){try{n=l.decode(A)}catch(s){L(`Failed to decode salt: ${s}`);return}try{i=new TextDecoder("utf-8",{fatal:!0}).decode(n),R.textSalt.value=i}catch{}}else n=new Uint8Array(16),crypto.getRandomValues(n),_=!0;_&&(A=l.encode(n),R.salt.value=A);const N=parseInt(R.timeCost.value);parseInt(R.threads.value);const a=R.memoryCost.value.toUpperCase();let G=0;if(a.endsWith("MB"))G=1024*parseInt(a);else if(a.endsWith("GB"))G=1024*1024*parseInt(a);else try{if(G=parseInt(a),isNaN(G))throw"Value entered in form is NaN"}catch(s){const P=`Failed to parse memory cost (${s})`;L(`Error: ${P}`);return}const b={mode:R.mode.value,password:R.password.value.normalize("NFC"),salt:n,timeCost:N,memoryCost:G,threads:1,hashLen:32};console.table(b);const w=performance.now(),h=await o.postMessage({method:T.Methods.Hash,params:b});let f=performance.now()-w;h.code===0?L(l.encode(h.body)):r(h.code);const S=1e3,I=60*S,g=Math.floor(f/I);f-=g*I;const U=Math.floor(f/S);f-=U*S;const H=f.toFixed(2);R.timerValue.textContent=`${g}m ${U}s ${H}ms`};
