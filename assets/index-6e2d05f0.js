(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const O of document.querySelectorAll('link[rel="modulepreload"]'))a(O);new MutationObserver(O=>{for(const e of O)if(e.type==="childList")for(const T of e.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&a(T)}).observe(document,{childList:!0,subtree:!0});function n(O){const e={};return O.integrity&&(e.integrity=O.integrity),O.referrerpolicy&&(e.referrerPolicy=O.referrerpolicy),O.crossorigin==="use-credentials"?e.credentials="include":O.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(O){if(O.ep)return;O.ep=!0;const e=n(O);fetch(O.href,e)}})();/**
 * @license
 * @very-amused/argon2-wasm v0.3.4
 * MIT License
 * Copyright (c) 2022 Keith Scroggs
 */class p{constructor(t){this.worker=t,this.worker.addEventListener("message",n=>{this.onMessage(n)},!0)}onMessage(t){this.resolve&&this.resolve(t.data)}postMessage(t,n=[]){const a=new Promise(O=>{this.resolve=O});return this.worker.postMessage(t,n),a}terminate(){this.worker.removeEventListener("message",t=>{this.onMessage(t)},!0),this.worker.terminate()}}var s;(function(_){_.WorkerConnection=p,function(t){t[t.LoadArgon2=0]="LoadArgon2",t[t.Hash2i=1]="Hash2i",t[t.UnloadArgon2=2]="UnloadArgon2"}(_.Methods||(_.Methods={})),function(t){t[t.ARGON2_OK=0]="ARGON2_OK",t[t.ARGON2_OUTPUT_PTR_NULL=-1]="ARGON2_OUTPUT_PTR_NULL",t[t.ARGON2_OUTPUT_TOO_SHORT=-2]="ARGON2_OUTPUT_TOO_SHORT",t[t.ARGON2_OUTPUT_TOO_LONG=-3]="ARGON2_OUTPUT_TOO_LONG",t[t.ARGON2_PWD_TOO_SHORT=-4]="ARGON2_PWD_TOO_SHORT",t[t.ARGON2_PWD_TOO_LONG=-5]="ARGON2_PWD_TOO_LONG",t[t.ARGON2_SALT_TOO_SHORT=-6]="ARGON2_SALT_TOO_SHORT",t[t.ARGON2_SALT_TOO_LONG=-7]="ARGON2_SALT_TOO_LONG",t[t.ARGON2_AD_TOO_SHORT=-8]="ARGON2_AD_TOO_SHORT",t[t.ARGON2_AD_TOO_LONG=-9]="ARGON2_AD_TOO_LONG",t[t.ARGON2_SECRET_TOO_SHORT=-10]="ARGON2_SECRET_TOO_SHORT",t[t.ARGON2_SECRET_TOO_LONG=-11]="ARGON2_SECRET_TOO_LONG",t[t.ARGON2_TIME_TOO_SMALL=-12]="ARGON2_TIME_TOO_SMALL",t[t.ARGON2_TIME_TOO_LARGE=-13]="ARGON2_TIME_TOO_LARGE",t[t.ARGON2_MEMORY_TOO_LITTLE=-14]="ARGON2_MEMORY_TOO_LITTLE",t[t.ARGON2_MEMORY_TOO_MUCH=-15]="ARGON2_MEMORY_TOO_MUCH",t[t.ARGON2_LANES_TOO_FEW=-16]="ARGON2_LANES_TOO_FEW",t[t.ARGON2_LANES_TOO_MANY=-17]="ARGON2_LANES_TOO_MANY",t[t.ARGON2_PWD_PTR_MISMATCH=-18]="ARGON2_PWD_PTR_MISMATCH",t[t.ARGON2_SALT_PTR_MISMATCH=-19]="ARGON2_SALT_PTR_MISMATCH",t[t.ARGON2_SECRET_PTR_MISMATCH=-20]="ARGON2_SECRET_PTR_MISMATCH",t[t.ARGON2_AD_PTR_MISMATCH=-21]="ARGON2_AD_PTR_MISMATCH",t[t.ARGON2_MEMORY_ALLOCATION_ERROR=-22]="ARGON2_MEMORY_ALLOCATION_ERROR",t[t.ARGON2_FREE_MEMORY_CBK_NULL=-23]="ARGON2_FREE_MEMORY_CBK_NULL",t[t.ARGON2_ALLOCATE_MEMORY_CBK_NULL=-24]="ARGON2_ALLOCATE_MEMORY_CBK_NULL",t[t.ARGON2_INCORRECT_PARAMETER=-25]="ARGON2_INCORRECT_PARAMETER",t[t.ARGON2_INCORRECT_TYPE=-26]="ARGON2_INCORRECT_TYPE",t[t.ARGON2_OUT_PTR_MISMATCH=-27]="ARGON2_OUT_PTR_MISMATCH",t[t.ARGON2_THREADS_TOO_FEW=-28]="ARGON2_THREADS_TOO_FEW",t[t.ARGON2_THREADS_TOO_MANY=-29]="ARGON2_THREADS_TOO_MANY",t[t.ARGON2_MISSING_ARGS=-30]="ARGON2_MISSING_ARGS",t[t.ARGON2_ENCODING_FAIL=-31]="ARGON2_ENCODING_FAIL",t[t.ARGON2_DECODING_FAIL=-32]="ARGON2_DECODING_FAIL",t[t.ARGON2_THREAD_FAIL=-33]="ARGON2_THREAD_FAIL",t[t.ARGON2_DECODING_LENGTH_FAIL=-34]="ARGON2_DECODING_LENGTH_FAIL",t[t.ARGON2_VERIFY_MISMATCH=-35]="ARGON2_VERIFY_MISMATCH",t[t.ARGON2WASM_UNKNOWN=1]="ARGON2WASM_UNKNOWN",t[t.ARGON2WASM_BAD_REQUEST=2]="ARGON2WASM_BAD_REQUEST",t[t.ARGON2WASM_UNSUPPORTED_BROWSER=3]="ARGON2WASM_UNSUPPORTED_BROWSER"}(_.ErrorCodes||(_.ErrorCodes={}))})(s||(s={}));const M=new s.WorkerConnection(new Worker("./argon2/worker.js")),N=document.querySelector.bind(document),R={password:N("input#password"),salt:N("input#salt"),timeCost:N("input#t_cost"),memoryCost:N("input#m_cost"),simd:N("input#simd_enabled"),run:N("input#submit"),result:N("span#result"),timer:N("section#timer"),timerValue:N("span#timer_value"),form:N("form#demoForm")};let u=R.simd.checked;(async function(){const _=await M.postMessage({method:s.Methods.LoadArgon2,params:{wasmRoot:".",simd:u,pthread:!0}});_.code!==0&&m(_.code)})();document.onclose=()=>{M.terminate()};function c(_){R.run.disabled=!1,R.result.textContent=_}function m(_){let t="";for(const n in s.ErrorCodes);c(`Error: ${t} (code ${_})`)}R.form.onsubmit=async _=>{_.preventDefault(),R.run.disabled=!0,R.result.textContent="";const t=R.simd.checked;if(t!==u){const A=await M.postMessage({method:s.Methods.LoadArgon2,params:{wasmRoot:".",simd:t,pthread:!1}});if(A.code!==0){m(A.code);return}u=t}let n,a=R.salt.value;if(a.length)try{const A=atob(a);n=new Uint8Array(A.length);for(let i=0;i<A.length;i++)n[i]=A.charCodeAt(i)}catch(A){const i=`Failed to decode salt (${A})`;c(`Error: ${i}`);return}else n=new Uint8Array(16),crypto.getRandomValues(n),a=btoa(String.fromCharCode.apply(null,Array.from(n))),R.salt.value=a;const O=parseInt(R.timeCost.value),e=R.memoryCost.value.toUpperCase();let T=0;if(e.endsWith("MB"))T=1024*parseInt(e);else if(e.endsWith("GB"))T=1024*1024*parseInt(e);else try{if(T=parseInt(e),isNaN(T))throw"Value entered in form is NaN"}catch(A){const i=`Failed to parse memory cost (${A})`;c(`Error: ${i}`);return}const L=performance.now(),l=await M.postMessage({method:s.Methods.Hash2i,params:{password:R.password.value.normalize("NFC"),salt:n,timeCost:O,memoryCost:T,threads:16,hashLen:32}});let G=performance.now()-L;if(console.log(l),l.code===0){const A=btoa(String.fromCharCode.apply(null,Array.from(l.body)));c(A)}else m(l.code);const S=Math.floor(G/6e4).toString();G%=6e4;const o=Math.floor(G/1e3).toString();G%=1e3;const f=G.toString();R.timerValue.textContent=`${S}m ${o}s ${f}ms`};
