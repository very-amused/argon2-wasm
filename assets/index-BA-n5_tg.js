(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))R(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const T of n.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&R(T)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function R(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();/**
 * @license
 * @very-amused/argon2-wasm v0.4.0
 * MIT License
 * Copyright (c) 2023 Keith Scroggs
 */class D{constructor(t){this.worker=t,this.worker.addEventListener("message",s=>{this.onMessage(s)},!0)}onMessage(t){this.resolve&&this.resolve(t.data)}postMessage(t,s=[]){const R=new Promise(e=>{this.resolve=e});return this.worker.postMessage(t,s),R}terminate(){this.worker.removeEventListener("message",t=>{this.onMessage(t)},!0),this.worker.terminate()}}var N;(function(_){_.WorkerConnection=D,function(t){t[t.LoadArgon2=0]="LoadArgon2",t[t.Hash2i=1]="Hash2i",t[t.Hash2d=2]="Hash2d",t[t.Hash2id=3]="Hash2id",t[t.UnloadArgon2=4]="UnloadArgon2"}(_.Methods||(_.Methods={})),function(t){t[t.ARGON2_OK=0]="ARGON2_OK",t[t.ARGON2_OUTPUT_PTR_NULL=-1]="ARGON2_OUTPUT_PTR_NULL",t[t.ARGON2_OUTPUT_TOO_SHORT=-2]="ARGON2_OUTPUT_TOO_SHORT",t[t.ARGON2_OUTPUT_TOO_LONG=-3]="ARGON2_OUTPUT_TOO_LONG",t[t.ARGON2_PWD_TOO_SHORT=-4]="ARGON2_PWD_TOO_SHORT",t[t.ARGON2_PWD_TOO_LONG=-5]="ARGON2_PWD_TOO_LONG",t[t.ARGON2_SALT_TOO_SHORT=-6]="ARGON2_SALT_TOO_SHORT",t[t.ARGON2_SALT_TOO_LONG=-7]="ARGON2_SALT_TOO_LONG",t[t.ARGON2_AD_TOO_SHORT=-8]="ARGON2_AD_TOO_SHORT",t[t.ARGON2_AD_TOO_LONG=-9]="ARGON2_AD_TOO_LONG",t[t.ARGON2_SECRET_TOO_SHORT=-10]="ARGON2_SECRET_TOO_SHORT",t[t.ARGON2_SECRET_TOO_LONG=-11]="ARGON2_SECRET_TOO_LONG",t[t.ARGON2_TIME_TOO_SMALL=-12]="ARGON2_TIME_TOO_SMALL",t[t.ARGON2_TIME_TOO_LARGE=-13]="ARGON2_TIME_TOO_LARGE",t[t.ARGON2_MEMORY_TOO_LITTLE=-14]="ARGON2_MEMORY_TOO_LITTLE",t[t.ARGON2_MEMORY_TOO_MUCH=-15]="ARGON2_MEMORY_TOO_MUCH",t[t.ARGON2_LANES_TOO_FEW=-16]="ARGON2_LANES_TOO_FEW",t[t.ARGON2_LANES_TOO_MANY=-17]="ARGON2_LANES_TOO_MANY",t[t.ARGON2_PWD_PTR_MISMATCH=-18]="ARGON2_PWD_PTR_MISMATCH",t[t.ARGON2_SALT_PTR_MISMATCH=-19]="ARGON2_SALT_PTR_MISMATCH",t[t.ARGON2_SECRET_PTR_MISMATCH=-20]="ARGON2_SECRET_PTR_MISMATCH",t[t.ARGON2_AD_PTR_MISMATCH=-21]="ARGON2_AD_PTR_MISMATCH",t[t.ARGON2_MEMORY_ALLOCATION_ERROR=-22]="ARGON2_MEMORY_ALLOCATION_ERROR",t[t.ARGON2_FREE_MEMORY_CBK_NULL=-23]="ARGON2_FREE_MEMORY_CBK_NULL",t[t.ARGON2_ALLOCATE_MEMORY_CBK_NULL=-24]="ARGON2_ALLOCATE_MEMORY_CBK_NULL",t[t.ARGON2_INCORRECT_PARAMETER=-25]="ARGON2_INCORRECT_PARAMETER",t[t.ARGON2_INCORRECT_TYPE=-26]="ARGON2_INCORRECT_TYPE",t[t.ARGON2_OUT_PTR_MISMATCH=-27]="ARGON2_OUT_PTR_MISMATCH",t[t.ARGON2_THREADS_TOO_FEW=-28]="ARGON2_THREADS_TOO_FEW",t[t.ARGON2_THREADS_TOO_MANY=-29]="ARGON2_THREADS_TOO_MANY",t[t.ARGON2_MISSING_ARGS=-30]="ARGON2_MISSING_ARGS",t[t.ARGON2_ENCODING_FAIL=-31]="ARGON2_ENCODING_FAIL",t[t.ARGON2_DECODING_FAIL=-32]="ARGON2_DECODING_FAIL",t[t.ARGON2_THREAD_FAIL=-33]="ARGON2_THREAD_FAIL",t[t.ARGON2_DECODING_LENGTH_FAIL=-34]="ARGON2_DECODING_LENGTH_FAIL",t[t.ARGON2_VERIFY_MISMATCH=-35]="ARGON2_VERIFY_MISMATCH",t[t.ARGON2WASM_UNKNOWN=1]="ARGON2WASM_UNKNOWN",t[t.ARGON2WASM_BAD_REQUEST=2]="ARGON2WASM_BAD_REQUEST",t[t.ARGON2WASM_UNSUPPORTED_BROWSER=3]="ARGON2WASM_UNSUPPORTED_BROWSER"}(_.ErrorCodes||(_.ErrorCodes={}))})(N||(N={}));const M=new N.WorkerConnection(new Worker("./argon2/worker.js")),a=document.querySelector.bind(document),O={password:a("input#password"),salt:a("input#salt"),textSalt:a("input#text_salt"),timeCost:a("input#t_cost"),memoryCost:a("input#m_cost"),threads:a("input#threads"),mode:a("select#argon2_mode"),simd:a("input#simd_enabled"),pthread:a("input#pthread_enabled"),run:a("input#submit"),result:a("span#result"),timer:a("section#timer"),timerValue:a("span#timer_value"),form:a("form#demoForm")};let o=O.simd.checked,p=O.pthread.checked;(async function(){const _=await M.postMessage({method:N.Methods.LoadArgon2,params:{wasmRoot:".",simd:o,pthread:p}});_.code!==0&&h(_.code)})();document.onclose=()=>{M.terminate()};function m(_){O.run.disabled=!1,O.result.textContent=_}function h(_){let t="";for(const s in N.ErrorCodes)if(N.ErrorCodes[s]===_){t=s;break}m(`Error: ${t} (code ${_})`)}O.form.onsubmit=async _=>{_.preventDefault(),O.run.disabled=!0,O.result.textContent="";const t=O.simd.checked,s=O.pthread.checked;if(t!==o||s!==p){const A=await M.postMessage({method:N.Methods.LoadArgon2,params:{wasmRoot:".",simd:t,pthread:s}});if(A.code!==0){h(A.code);return}o=t,p=s}let R,e=!1,n=O.salt.value;const T=O.textSalt.value;if(T.length>=8)R=new TextEncoder().encode(T),e=!0;else if(n.length>0)try{const A=atob(n);R=new Uint8Array(A.length);for(let i=0;i<A.length;i++)R[i]=A.charCodeAt(i)}catch(A){const i=`Failed to decode salt (${A})`;m(`Error: ${i}`);return}else R=new Uint8Array(16),crypto.getRandomValues(R),e=!0;e&&(n=btoa(String.fromCharCode.apply(null,Array.from(R))),O.salt.value=n);const H=parseInt(O.timeCost.value),P=parseInt(O.threads.value),c=O.memoryCost.value.toUpperCase();let l=0;if(c.endsWith("MB"))l=1024*parseInt(c);else if(c.endsWith("GB"))l=1024*1024*parseInt(c);else try{if(l=parseInt(c),isNaN(l))throw"Value entered in form is NaN"}catch(A){const i=`Failed to parse memory cost (${A})`;m(`Error: ${i}`);return}let u;switch(O.mode.value){case"2i":u=N.Methods.Hash2i;break;case"2d":u=N.Methods.Hash2d;break;case"2id":u=N.Methods.Hash2id}const g=performance.now();console.log(R.byteLength);const L=await M.postMessage({method:u,params:{password:O.password.value.normalize("NFC"),salt:R,timeCost:H,memoryCost:l,threads:P,hashLen:32}});let G=performance.now()-g;if(L.code===0){const A=btoa(String.fromCharCode.apply(null,Array.from(L.body)));m(A)}else h(L.code);const S=1e3,f=60*S,I=Math.floor(G/f);G-=I*f;const d=Math.floor(G/S);G-=d*S;const U=G.toFixed(2);O.timerValue.textContent=`${I}m ${d}s ${U}ms`};
