(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))N(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&N(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function N(e){if(e.ep)return;e.ep=!0;const a=n(e);fetch(e.href,a)}})();/**
 * @license
 * @very-amused/argon2-wasm v0.3.4
 * MIT License
 * Copyright (c) 2023 Keith Scroggs
 */class H{constructor(t){this.worker=t,this.worker.addEventListener("message",n=>{this.onMessage(n)},!0)}onMessage(t){this.resolve&&this.resolve(t.data)}postMessage(t,n=[]){const N=new Promise(e=>{this.resolve=e});return this.worker.postMessage(t,n),N}terminate(){this.worker.removeEventListener("message",t=>{this.onMessage(t)},!0),this.worker.terminate()}}var i;(function(O){O.WorkerConnection=H,function(t){t[t.LoadArgon2=0]="LoadArgon2",t[t.Hash2i=1]="Hash2i",t[t.Hash2d=2]="Hash2d",t[t.Hash2id=3]="Hash2id",t[t.UnloadArgon2=4]="UnloadArgon2"}(O.Methods||(O.Methods={})),function(t){t[t.ARGON2_OK=0]="ARGON2_OK",t[t.ARGON2_OUTPUT_PTR_NULL=-1]="ARGON2_OUTPUT_PTR_NULL",t[t.ARGON2_OUTPUT_TOO_SHORT=-2]="ARGON2_OUTPUT_TOO_SHORT",t[t.ARGON2_OUTPUT_TOO_LONG=-3]="ARGON2_OUTPUT_TOO_LONG",t[t.ARGON2_PWD_TOO_SHORT=-4]="ARGON2_PWD_TOO_SHORT",t[t.ARGON2_PWD_TOO_LONG=-5]="ARGON2_PWD_TOO_LONG",t[t.ARGON2_SALT_TOO_SHORT=-6]="ARGON2_SALT_TOO_SHORT",t[t.ARGON2_SALT_TOO_LONG=-7]="ARGON2_SALT_TOO_LONG",t[t.ARGON2_AD_TOO_SHORT=-8]="ARGON2_AD_TOO_SHORT",t[t.ARGON2_AD_TOO_LONG=-9]="ARGON2_AD_TOO_LONG",t[t.ARGON2_SECRET_TOO_SHORT=-10]="ARGON2_SECRET_TOO_SHORT",t[t.ARGON2_SECRET_TOO_LONG=-11]="ARGON2_SECRET_TOO_LONG",t[t.ARGON2_TIME_TOO_SMALL=-12]="ARGON2_TIME_TOO_SMALL",t[t.ARGON2_TIME_TOO_LARGE=-13]="ARGON2_TIME_TOO_LARGE",t[t.ARGON2_MEMORY_TOO_LITTLE=-14]="ARGON2_MEMORY_TOO_LITTLE",t[t.ARGON2_MEMORY_TOO_MUCH=-15]="ARGON2_MEMORY_TOO_MUCH",t[t.ARGON2_LANES_TOO_FEW=-16]="ARGON2_LANES_TOO_FEW",t[t.ARGON2_LANES_TOO_MANY=-17]="ARGON2_LANES_TOO_MANY",t[t.ARGON2_PWD_PTR_MISMATCH=-18]="ARGON2_PWD_PTR_MISMATCH",t[t.ARGON2_SALT_PTR_MISMATCH=-19]="ARGON2_SALT_PTR_MISMATCH",t[t.ARGON2_SECRET_PTR_MISMATCH=-20]="ARGON2_SECRET_PTR_MISMATCH",t[t.ARGON2_AD_PTR_MISMATCH=-21]="ARGON2_AD_PTR_MISMATCH",t[t.ARGON2_MEMORY_ALLOCATION_ERROR=-22]="ARGON2_MEMORY_ALLOCATION_ERROR",t[t.ARGON2_FREE_MEMORY_CBK_NULL=-23]="ARGON2_FREE_MEMORY_CBK_NULL",t[t.ARGON2_ALLOCATE_MEMORY_CBK_NULL=-24]="ARGON2_ALLOCATE_MEMORY_CBK_NULL",t[t.ARGON2_INCORRECT_PARAMETER=-25]="ARGON2_INCORRECT_PARAMETER",t[t.ARGON2_INCORRECT_TYPE=-26]="ARGON2_INCORRECT_TYPE",t[t.ARGON2_OUT_PTR_MISMATCH=-27]="ARGON2_OUT_PTR_MISMATCH",t[t.ARGON2_THREADS_TOO_FEW=-28]="ARGON2_THREADS_TOO_FEW",t[t.ARGON2_THREADS_TOO_MANY=-29]="ARGON2_THREADS_TOO_MANY",t[t.ARGON2_MISSING_ARGS=-30]="ARGON2_MISSING_ARGS",t[t.ARGON2_ENCODING_FAIL=-31]="ARGON2_ENCODING_FAIL",t[t.ARGON2_DECODING_FAIL=-32]="ARGON2_DECODING_FAIL",t[t.ARGON2_THREAD_FAIL=-33]="ARGON2_THREAD_FAIL",t[t.ARGON2_DECODING_LENGTH_FAIL=-34]="ARGON2_DECODING_LENGTH_FAIL",t[t.ARGON2_VERIFY_MISMATCH=-35]="ARGON2_VERIFY_MISMATCH",t[t.ARGON2WASM_UNKNOWN=1]="ARGON2WASM_UNKNOWN",t[t.ARGON2WASM_BAD_REQUEST=2]="ARGON2WASM_BAD_REQUEST",t[t.ARGON2WASM_UNSUPPORTED_BROWSER=3]="ARGON2WASM_UNSUPPORTED_BROWSER"}(O.ErrorCodes||(O.ErrorCodes={}))})(i||(i={}));const u=new i.WorkerConnection(new Worker("./argon2/worker.js")),A=document.querySelector.bind(document),_={password:A("input#password"),salt:A("input#salt"),timeCost:A("input#t_cost"),memoryCost:A("input#m_cost"),mode:A("select#argon2_mode"),simd:A("input#simd_enabled"),pthread:A("input#pthread_enabled"),run:A("input#submit"),result:A("span#result"),timer:A("section#timer"),timerValue:A("span#timer_value"),form:A("form#demoForm")};let L=_.simd.checked,o=_.pthread.checked;(async function(){const O=await u.postMessage({method:i.Methods.LoadArgon2,params:{wasmRoot:".",simd:L,pthread:o}});O.code!==0&&S(O.code)})();document.onclose=()=>{u.terminate()};function m(O){_.run.disabled=!1,_.result.textContent=O}function S(O){let t="";for(const n in i.ErrorCodes)if(i.ErrorCodes[n]===O){t=n;break}m(`Error: ${t} (code ${O})`)}_.form.onsubmit=async O=>{O.preventDefault(),_.run.disabled=!0,_.result.textContent="";const t=_.simd.checked,n=_.pthread.checked;if(t!==L||n!==o){const R=await u.postMessage({method:i.Methods.LoadArgon2,params:{wasmRoot:".",simd:t,pthread:n}});if(R.code!==0){S(R.code);return}L=t,o=n}let N,e=_.salt.value;if(e.length)try{const R=atob(e);N=new Uint8Array(R.length);for(let T=0;T<R.length;T++)N[T]=R.charCodeAt(T)}catch(R){const T=`Failed to decode salt (${R})`;m(`Error: ${T}`);return}else N=new Uint8Array(16),crypto.getRandomValues(N),e=btoa(String.fromCharCode.apply(null,Array.from(N))),_.salt.value=e;const a=parseInt(_.timeCost.value),s=_.memoryCost.value.toUpperCase();let c=0;if(s.endsWith("MB"))c=1024*parseInt(s);else if(s.endsWith("GB"))c=1024*1024*parseInt(s);else try{if(c=parseInt(s),isNaN(c))throw"Value entered in form is NaN"}catch(R){const T=`Failed to parse memory cost (${R})`;m(`Error: ${T}`);return}let G;switch(_.mode.value){case"2i":G=i.Methods.Hash2i;break;case"2d":G=i.Methods.Hash2d;break;case"2id":G=i.Methods.Hash2id}const f=performance.now(),M=await u.postMessage({method:G,params:{password:_.password.value.normalize("NFC"),salt:N,timeCost:a,memoryCost:c,threads:n?navigator.hardwareConcurrency:1,hashLen:32}});let l=performance.now()-f;if(M.code===0){const R=btoa(String.fromCharCode.apply(null,Array.from(M.body)));m(R)}else S(M.code);const p=Math.floor(l/6e4).toString();l%=6e4;const h=Math.floor(l/1e3).toString();l%=1e3;const I=l.toFixed(2);_.timerValue.textContent=`${p}m ${h}s ${I}ms`};
