(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const R of e)if(R.type==="childList")for(const T of R.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&a(T)}).observe(document,{childList:!0,subtree:!0});function n(e){const R={};return e.integrity&&(R.integrity=e.integrity),e.referrerpolicy&&(R.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?R.credentials="include":e.crossorigin==="anonymous"?R.credentials="omit":R.credentials="same-origin",R}function a(e){if(e.ep)return;e.ep=!0;const R=n(e);fetch(e.href,R)}})();/**
 * @license
 * @very-amused/argon2-wasm v0.3.4
 * MIT License
 * Copyright (c) 2022 Keith Scroggs
 */class I{constructor(t){this.worker=t,this.worker.addEventListener("message",n=>{this.onMessage(n)},!0)}onMessage(t){this.resolve&&this.resolve(t.data)}postMessage(t,n=[]){const a=new Promise(e=>{this.resolve=e});return this.worker.postMessage(t,n),a}terminate(){this.worker.removeEventListener("message",t=>{this.onMessage(t)},!0),this.worker.terminate()}}var s;(function(O){O.WorkerConnection=I,function(t){t[t.LoadArgon2=0]="LoadArgon2",t[t.Hash2i=1]="Hash2i",t[t.UnloadArgon2=2]="UnloadArgon2"}(O.Methods||(O.Methods={})),function(t){t[t.ARGON2_OK=0]="ARGON2_OK",t[t.ARGON2_OUTPUT_PTR_NULL=-1]="ARGON2_OUTPUT_PTR_NULL",t[t.ARGON2_OUTPUT_TOO_SHORT=-2]="ARGON2_OUTPUT_TOO_SHORT",t[t.ARGON2_OUTPUT_TOO_LONG=-3]="ARGON2_OUTPUT_TOO_LONG",t[t.ARGON2_PWD_TOO_SHORT=-4]="ARGON2_PWD_TOO_SHORT",t[t.ARGON2_PWD_TOO_LONG=-5]="ARGON2_PWD_TOO_LONG",t[t.ARGON2_SALT_TOO_SHORT=-6]="ARGON2_SALT_TOO_SHORT",t[t.ARGON2_SALT_TOO_LONG=-7]="ARGON2_SALT_TOO_LONG",t[t.ARGON2_AD_TOO_SHORT=-8]="ARGON2_AD_TOO_SHORT",t[t.ARGON2_AD_TOO_LONG=-9]="ARGON2_AD_TOO_LONG",t[t.ARGON2_SECRET_TOO_SHORT=-10]="ARGON2_SECRET_TOO_SHORT",t[t.ARGON2_SECRET_TOO_LONG=-11]="ARGON2_SECRET_TOO_LONG",t[t.ARGON2_TIME_TOO_SMALL=-12]="ARGON2_TIME_TOO_SMALL",t[t.ARGON2_TIME_TOO_LARGE=-13]="ARGON2_TIME_TOO_LARGE",t[t.ARGON2_MEMORY_TOO_LITTLE=-14]="ARGON2_MEMORY_TOO_LITTLE",t[t.ARGON2_MEMORY_TOO_MUCH=-15]="ARGON2_MEMORY_TOO_MUCH",t[t.ARGON2_LANES_TOO_FEW=-16]="ARGON2_LANES_TOO_FEW",t[t.ARGON2_LANES_TOO_MANY=-17]="ARGON2_LANES_TOO_MANY",t[t.ARGON2_PWD_PTR_MISMATCH=-18]="ARGON2_PWD_PTR_MISMATCH",t[t.ARGON2_SALT_PTR_MISMATCH=-19]="ARGON2_SALT_PTR_MISMATCH",t[t.ARGON2_SECRET_PTR_MISMATCH=-20]="ARGON2_SECRET_PTR_MISMATCH",t[t.ARGON2_AD_PTR_MISMATCH=-21]="ARGON2_AD_PTR_MISMATCH",t[t.ARGON2_MEMORY_ALLOCATION_ERROR=-22]="ARGON2_MEMORY_ALLOCATION_ERROR",t[t.ARGON2_FREE_MEMORY_CBK_NULL=-23]="ARGON2_FREE_MEMORY_CBK_NULL",t[t.ARGON2_ALLOCATE_MEMORY_CBK_NULL=-24]="ARGON2_ALLOCATE_MEMORY_CBK_NULL",t[t.ARGON2_INCORRECT_PARAMETER=-25]="ARGON2_INCORRECT_PARAMETER",t[t.ARGON2_INCORRECT_TYPE=-26]="ARGON2_INCORRECT_TYPE",t[t.ARGON2_OUT_PTR_MISMATCH=-27]="ARGON2_OUT_PTR_MISMATCH",t[t.ARGON2_THREADS_TOO_FEW=-28]="ARGON2_THREADS_TOO_FEW",t[t.ARGON2_THREADS_TOO_MANY=-29]="ARGON2_THREADS_TOO_MANY",t[t.ARGON2_MISSING_ARGS=-30]="ARGON2_MISSING_ARGS",t[t.ARGON2_ENCODING_FAIL=-31]="ARGON2_ENCODING_FAIL",t[t.ARGON2_DECODING_FAIL=-32]="ARGON2_DECODING_FAIL",t[t.ARGON2_THREAD_FAIL=-33]="ARGON2_THREAD_FAIL",t[t.ARGON2_DECODING_LENGTH_FAIL=-34]="ARGON2_DECODING_LENGTH_FAIL",t[t.ARGON2_VERIFY_MISMATCH=-35]="ARGON2_VERIFY_MISMATCH",t[t.ARGON2WASM_UNKNOWN=1]="ARGON2WASM_UNKNOWN",t[t.ARGON2WASM_BAD_REQUEST=2]="ARGON2WASM_BAD_REQUEST",t[t.ARGON2WASM_UNSUPPORTED_BROWSER=3]="ARGON2WASM_UNSUPPORTED_BROWSER"}(O.ErrorCodes||(O.ErrorCodes={}))})(s||(s={}));const M=new s.WorkerConnection(new Worker("./argon2/worker.js")),N=document.querySelector.bind(document),_={password:N("input#password"),salt:N("input#salt"),timeCost:N("input#t_cost"),memoryCost:N("input#m_cost"),simd:N("input#simd_enabled"),pthread:N("input#pthread_enabled"),run:N("input#submit"),result:N("span#result"),timer:N("section#timer"),timerValue:N("span#timer_value"),form:N("form#demoForm")};let m=_.simd.checked,L=_.pthread.checked;(async function(){const O=await M.postMessage({method:s.Methods.LoadArgon2,params:{wasmRoot:".",simd:m,pthread:L}});O.code!==0&&S(O.code)})();document.onclose=()=>{M.terminate()};function l(O){_.run.disabled=!1,_.result.textContent=O}function S(O){let t="";for(const n in s.ErrorCodes)if(s.ErrorCodes[n]===O){t=n;break}l(`Error: ${t} (code ${O})`)}_.form.onsubmit=async O=>{O.preventDefault(),_.run.disabled=!0,_.result.textContent="";const t=_.simd.checked,n=_.pthread.checked;if(t!==m||n!==L){const A=await M.postMessage({method:s.Methods.LoadArgon2,params:{wasmRoot:".",simd:t,pthread:n}});if(A.code!==0){S(A.code);return}m=t,L=n}let a,e=_.salt.value;if(e.length)try{const A=atob(e);a=new Uint8Array(A.length);for(let i=0;i<A.length;i++)a[i]=A.charCodeAt(i)}catch(A){const i=`Failed to decode salt (${A})`;l(`Error: ${i}`);return}else a=new Uint8Array(16),crypto.getRandomValues(a),e=btoa(String.fromCharCode.apply(null,Array.from(a))),_.salt.value=e;const R=parseInt(_.timeCost.value),T=_.memoryCost.value.toUpperCase();let G=0;if(T.endsWith("MB"))G=1024*parseInt(T);else if(T.endsWith("GB"))G=1024*1024*parseInt(T);else try{if(G=parseInt(T),isNaN(G))throw"Value entered in form is NaN"}catch(A){const i=`Failed to parse memory cost (${A})`;l(`Error: ${i}`);return}const o=performance.now(),u=await M.postMessage({method:s.Methods.Hash2i,params:{password:_.password.value.normalize("NFC"),salt:a,timeCost:R,memoryCost:G,threads:n?navigator.hardwareConcurrency:1,hashLen:32}});let c=performance.now()-o;if(u.code===0){const A=btoa(String.fromCharCode.apply(null,Array.from(u.body)));l(A)}else S(u.code);const f=Math.floor(c/6e4).toString();c%=6e4;const p=Math.floor(c/1e3).toString();c%=1e3;const h=c.toFixed(2);_.timerValue.textContent=`${f}m ${p}s ${h}ms`};
